{% extends 'base.html' %}


{% block content %}

{% include 'navbar.html' %} <br>


		<div class="container">
			
	  <div class="row align-items-start">
	    <div class="col">
	    	<h1>MESSAGES</h1><br><br>	
	    </div>
	    <div class="col">
	      <button class="btn btn-primary">New Message</button>
	    </div>
	  </div>

		<div class="row align-items-start">
	    <div class="col">
	    	{% for room in chatrooms reversed %}

	    	<div>
	    		{% for rm_user in room.users.all %}
		    		{% if rm_user.username != user.username %}
		    		<a href="{% url 'view_convo' room.id %}"><h2>Convo with: {{rm_user}} </h2></a>
		    			<br>
		    		{% endif %}
	    		{% endfor %}
	    	</div>
			
				{% endfor %}
	    </div>
	    <div class="col">
	    	<div class="container">
				    <div class="row mt-4">
				        <div class="col">
				            <div class="alert alert-warning text-center">
				            		 {% if messages %}
											        <h2>CONVERSATION {{ messages.0.room.name }}</h2>
											   {% endif %}
				            </div>
				        </div>
				    </div>
				    <div class="row">
				        <div class="col">
				            <div class="overflow-auto border rounded p-3" style="max-height: 300px;">
				                {% if not messages %}
				                    <div class="alert alert-secondary">
				                        <strong>No conversation</strong>
				                    </div>
				                {% else %}
				                    {% for message in messages %}
				                        <div class="alert alert-secondary mb-3">
				                            <strong>Sender: {{ message.sender }}</strong>
				                            <p>{{ message.content|linebreaks }}</p>
				                            <small>{{ message.timestamp }}</small>
				                            <small>{{ message.room.name }}</small>
				                        </div>
				                    {% endfor %}
				                {% endif %}
				            </div>
				        </div>
				    </div>
				    <div class="row mt-3">
				        <div class="col">
								    <form>
								        <div class="input-group">
								            <textarea class="form-control" rows="3" placeholder="Type your message"></textarea>
								            <div class="input-group-append">
								                <button type="submit" class="btn btn-primary">Send</button>
								            </div>
								        </div>
								    </form>
								</div>

				    </div>
				</div>
	
	    </div>
	  </div>


		</div>




{% endblock %}